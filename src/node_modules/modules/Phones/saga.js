import { takeEvery, put, fork, call } from 'redux-saga/effects';

import {FetchPhonesFailure, FetchPhonesStart, FetchPhonesSuccess} from './actions'
import {getPhones as fetchPhonesApi} from 'api'


function* fetchPhonesFlow() {
  try {
    const phones = yield call(fetchPhonesApi);
    yield put(FetchPhonesSuccess(phones));
  } catch (err) {
    yield put(FetchPhonesFailure(err));
  }
}

function* fetchPhones() {
  yield takeEvery(FetchPhonesStart, fetchPhonesFlow)
}

export default function* () {
  yield fork(fetchPhones)
}
