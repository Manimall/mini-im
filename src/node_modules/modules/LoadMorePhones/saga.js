import { takeEvery, put, fork, call } from 'redux-saga/effects';

import {LoadMorePhonesStart, LoadMorePhonesSuccess, LoadMorePhonesFailure} from './actions'
import {loadMorePhones as loadMorePhonesApi} from 'api'


function* fetchPhonesFlow({ payload }) {
  const offset = payload;
  // console.log(payload);

  try {
    const phones = yield call(loadMorePhonesApi, offset);
    yield put(LoadMorePhonesSuccess(phones));
  } catch (err) {
    yield put(LoadMorePhonesFailure(err));
  }
}

function* loadMorePhones() {
  yield takeEvery(LoadMorePhonesStart, fetchPhonesFlow);
}

export default function* () {
  yield fork(loadMorePhones)
}
