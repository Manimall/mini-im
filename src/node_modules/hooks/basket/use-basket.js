import {useCallback} from 'react'
import {useDispatch, useSelector} from 'react-redux'

import {getBasketPhonesWithCount, getTotalBasketPrice} from 'selectors'
import {CleanBasket, RemovePhoneFromBasket} from 'modules/Basket'


const useBasket = () => {
  const { phonesInBasket, totalPrice } = (
    useSelector((state) => ({
      phonesInBasket: getBasketPhonesWithCount(state),
      totalPrice: getTotalBasketPrice(state),
    }))
  );

  const dispatch = useDispatch()

  const removePhoneFromBasketCb = useCallback((id) => {
    dispatch(RemovePhoneFromBasket(id))
  }, [dispatch]);

  const cleanBasket = () => dispatch(CleanBasket())
  // const cleanBasket = useCallback(() => dispatch(CleanBasket()), [dispatch])

  const checkoutBasket = useCallback((phones) => {
    alert(JSON.stringify(phones))
  }, []);
  
  return {
    phonesInBasket,
    totalPrice,
    removePhoneFromBasketCb,
    cleanBasket,
    checkoutBasket,
  }
}

export default useBasket
