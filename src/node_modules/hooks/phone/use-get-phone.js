import {useEffect, useCallback} from 'react'
import {useDispatch, useSelector} from 'react-redux'

import {FetchPhoneByIdStart} from 'modules/SinglePhone'
import {getPhoneById} from 'selectors'


const useGetPhone = (id) => {
  const dispatch = useDispatch();

  const getPhone = useCallback(() => {
    dispatch(FetchPhoneByIdStart(id))
  }, [dispatch, id]);


  useEffect(() => {
    getPhone()
  }, [getPhone])

  const { phone, isLoading, error } = useSelector((state) => ({
    phone: getPhoneById(state, state.singlePhonePage.id),
    isLoading: state.entities.isLoading,
    error: state.entities.err,
  }));

  return {
    phone,
    isLoading,
    error,
  }
}

export default useGetPhone
