import {useCallback, useEffect} from 'react'
import {useDispatch, useSelector} from 'react-redux'

import {FetchCategoriesStart} from 'modules/Categories'
import {getActiveCategoryId, getCategories} from 'selectors'
import useGetOwnProps from 'hooks/use-get-ownProps'


const useGetCategories = () => {
  const ownProps = useGetOwnProps();
  const dispatch = useDispatch();

  const requestCategories = useCallback(() => {
    dispatch(FetchCategoriesStart());
  }, [dispatch]);

  useEffect(() => {
    requestCategories();
  }, [requestCategories]);

  const {  categories, activeCategoryId } = useSelector((state) => ({
    categories: getCategories(state),
    activeCategoryId: getActiveCategoryId(ownProps),
  }));

  return {
    categories,
    activeCategoryId,
  }
}

export default useGetCategories
