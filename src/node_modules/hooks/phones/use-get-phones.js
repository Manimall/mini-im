import {useCallback, useEffect} from 'react'
import {useSelector, useDispatch} from 'react-redux'

import {getPhones} from 'selectors'
import useGetOwnProps from 'hooks/use-get-ownProps'
import {FetchPhonesStart} from 'modules/Phones'


const useGetPhones = () => {
  const ownProps = useGetOwnProps();

  const { phones, isLoading, error } = useSelector((state) => ({
    phones: getPhones(state, ownProps),
    isLoading: state.entities.isLoading,
    error: state.entities.err,
  }));

  const dispatch = useDispatch();

  const requestPhones = useCallback(() => {
    dispatch(FetchPhonesStart());
  }, [dispatch]);

  useEffect(() => {
    requestPhones();
  }, [requestPhones]);

  return {
    phones,
    isLoading,
    error,
  }
}

export default useGetPhones
